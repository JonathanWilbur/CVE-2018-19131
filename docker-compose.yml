version: '3.3'

networks:
  every:
    external: false

services:

  squid:
    container_name: 'vulnerable'
    hostname: 'vulnerable'
    image: 'sameersbn/squid'
    networks:
      - every
    ports:
      - '3128:3128'
      - '3129:3129'
    volumes:
      - "$PWD/source/squid.conf:/etc/squid/squid.conf:ro"
      - "$PWD/source/ERR_CERT_AUTHORITY_INVALID:/etc/squid/errors/ERR_CERT_AUTHORITY_INVALID:ro"
      - "$PWD/key.pem:/key.pem:ro"
      - "$PWD/cert.pem:/cert.pem:ro"

  web:
    container_name: 'malicious'
    hostname: 'malicious'
    image: 'nginx:latest'
    networks:
      - every
    volumes:
      - "$PWD/source/nginx.conf:/etc/nginx/nginx.conf:ro"
      - "$PWD/source/index.html:/usr/share/nginx/html/index.html:ro"
      - "$PWD/key.pem:/key.pem:ro"
      - "$PWD/cert.pem:/cert.pem:ro"